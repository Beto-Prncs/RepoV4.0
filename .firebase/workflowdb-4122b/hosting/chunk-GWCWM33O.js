import{K as l,M as y,N as w,O as o,P as u,Q as E,S as s,U as i,W as q,X as n}from"./chunk-7XAWW6QG.js";import{T as f,Z as h,s as d}from"./chunk-GCXAMRXK.js";import{g as p}from"./chunk-OIKEWKHE.js";var C=(()=>{class t{firestore=h(l);getCompanies(){let r=o(this.firestore,"Empresa");return y(r,{idField:"IdEmpresa"}).pipe(d(e=>e))}addCompany(r){return p(this,null,function*(){try{let e=o(this.firestore,"Empresa"),c=i(e,n("Nombre","==",r.Nombre));if(!(yield s(c)).empty)throw new Error("Ya existe una empresa con este nombre");let a=yield w(o(this.firestore,"Empresa"),r);return yield q(a,{IdEmpresa:a.id}),a.id}catch(e){throw console.error("Error al a\xF1adir empresa:",e),e}})}deleteCompany(r){return p(this,null,function*(){try{let e=o(this.firestore,"Reportes"),c=i(e,n("IdEmpresa","==",r));if(!(yield s(c)).empty)throw new Error("No se puede eliminar la empresa porque hay reportes asociados a ella");let a=i(o(this.firestore,"Empresa"),n("IdEmpresa","==",r)),m=yield s(a);if(m.empty)throw new Error("Empresa no encontrada");yield u(E(this.firestore,"Empresa",m.docs[0].id))}catch(e){throw console.error("Error al eliminar empresa:",e),e}})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=f({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();export{C as a};
//# sourceMappingURL=chunk-GWCWM33O.js.map
