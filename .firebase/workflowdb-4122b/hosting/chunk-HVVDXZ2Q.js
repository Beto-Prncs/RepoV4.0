import{a as N}from"./chunk-RT2AZM63.js";import"./chunk-NOIAGMWN.js";import{b as W,d as j,e as z,f as A,g as G,h as B,s as H}from"./chunk-KJJQOZ7I.js";import"./chunk-SLGRDKNT.js";import{c as O,e as R,k as L,s as I,u as F}from"./chunk-ZX2O5KE6.js";import{Ab as u,Bb as C,Eb as _,Fb as d,Mb as o,Nb as V,Ob as S,Qb as b,Rb as P,Sb as M,Ta as s,Vb as T,Ya as v,bb as k,ga as p,gb as h,ha as m,ia as f,ja as w,ob as c,pb as E,qb as y,yb as t,zb as n}from"./chunk-ISKDQYGU.js";import{g as x}from"./chunk-OIKEWKHE.js";var D=(i,l)=>({error:i,success:l});function q(i,l){if(i&1&&(t(0,"div",12),o(1),n()),i&2){let e=d(2);c("ngClass",T(2,D,e.messageType==="error",e.messageType==="success")),s(),S(" ",e.message," ")}}function Y(i,l){i&1&&(t(0,"span"),o(1,"Enviar instrucciones"),n())}function K(i,l){i&1&&(t(0,"span",13),f(),t(1,"svg",14),u(2,"circle",15),n(),o(3," Enviando... "),n())}function Q(i,l){if(i&1){let e=C();t(0,"div")(1,"p"),o(2,"Ingresa tu correo electr\xF3nico para recibir instrucciones de recuperaci\xF3n"),n(),h(3,q,2,5,"div",6),t(4,"form",7)(5,"label"),o(6,"Correo electr\xF3nico"),n(),t(7,"input",8),M("ngModelChange",function(r){p(e);let g=d();return P(g.email,r)||(g.email=r),m(r)}),n(),t(8,"button",9),_("click",function(){p(e);let r=d();return m(r.sendRecoveryEmail())}),h(9,Y,2,0,"span",5)(10,K,4,0,"span",10),n(),t(11,"button",11),_("click",function(){p(e);let r=d();return m(r.goToLogin())}),o(12," Volver al inicio de sesi\xF3n "),n()()()}if(i&2){let e=d();s(3),c("ngIf",e.message),s(4),y("input-error",e.messageType==="error"),b("ngModel",e.email),s(),c("disabled",e.isLoading||!e.email),s(),c("ngIf",!e.isLoading),s(),c("ngIf",e.isLoading)}}function U(i,l){if(i&1){let e=C();t(0,"div")(1,"div",16),f(),t(2,"svg",17),u(3,"path",18)(4,"path",19),n()(),w(),t(5,"h2"),o(6,"Correo enviado"),n(),t(7,"p"),o(8,"Hemos enviado instrucciones para recuperar tu contrase\xF1a a "),t(9,"strong"),o(10),n()(),t(11,"p"),o(12,"Revisa tu bandeja de entrada y sigue las instrucciones en el correo."),n(),t(13,"button",20),_("click",function(){p(e);let r=d();return m(r.goToLogin())}),o(14," Volver al inicio de sesi\xF3n "),n()()}if(i&2){let e=d();s(10),V(e.email)}}function Z(i,l){if(i&1&&(t(0,"div",12),o(1),n()),i&2){let e=d(2);c("ngClass",T(2,D,e.messageType==="error",e.messageType==="success")),s(),S(" ",e.message," ")}}function J(i,l){i&1&&(t(0,"span"),o(1,"Cambiar contrase\xF1a"),n())}function X(i,l){i&1&&(t(0,"span",13),f(),t(1,"svg",14),u(2,"circle",15),n(),o(3," Procesando... "),n())}function $(i,l){if(i&1){let e=C();t(0,"div")(1,"h2"),o(2,"Establece una nueva contrase\xF1a"),n(),h(3,Z,2,5,"div",6),t(4,"form",7)(5,"label"),o(6,"Nueva contrase\xF1a"),n(),t(7,"div",21)(8,"input",22),M("ngModelChange",function(r){p(e);let g=d();return P(g.newPassword,r)||(g.newPassword=r),m(r)}),n(),t(9,"button",23),_("click",function(){p(e);let r=d();return m(r.togglePasswordVisibility())}),f(),t(10,"svg",17),u(11,"path",24)(12,"circle",25)(13,"path",26),n()()(),w(),t(14,"label"),o(15,"Confirmar contrase\xF1a"),n(),t(16,"input",27),M("ngModelChange",function(r){p(e);let g=d();return P(g.confirmPassword,r)||(g.confirmPassword=r),m(r)}),n(),t(17,"button",9),_("click",function(){p(e);let r=d();return m(r.resetPassword())}),h(18,J,2,0,"span",5)(19,X,4,0,"span",10),n()()()}if(i&2){let e=d();s(3),c("ngIf",e.message),s(5),y("input-error",e.messageType==="error"),c("type",e.showPassword?"text":"password"),b("ngModel",e.newPassword),s(5),E("display",e.showPassword?"inline":"none"),s(3),y("input-error",e.messageType==="error"),b("ngModel",e.confirmPassword),s(),c("disabled",e.isLoading||!e.newPassword||!e.confirmPassword),s(),c("ngIf",!e.isLoading),s(),c("ngIf",e.isLoading)}}function ee(i,l){if(i&1){let e=C();t(0,"div")(1,"div",16),f(),t(2,"svg",17),u(3,"path",18)(4,"path",19),n()(),w(),t(5,"h2"),o(6,"\xA1Contrase\xF1a actualizada!"),n(),t(7,"p"),o(8,"Tu contrase\xF1a ha sido cambiada exitosamente."),n(),t(9,"button",20),_("click",function(){p(e);let r=d();return m(r.goToLogin())}),o(10," Iniciar sesi\xF3n "),n()()}}var ce=(()=>{class i{authService;router;route;step=1;isLoading=!1;message="";messageType="error";email="";newPassword="";confirmPassword="";showPassword=!1;actionCode="";constructor(e,a,r){this.authService=e,this.router=a,this.route=r}ngOnInit(){this.route.queryParams.subscribe(e=>{let a=e.oobCode;e.mode==="resetPassword"&&a&&(this.actionCode=a,this.step=3,this.verifyActionCode(a))})}verifyActionCode(e){return x(this,null,function*(){this.isLoading=!0,this.message="";try{yield this.authService.verifyPasswordResetCode(e),this.isLoading=!1}catch(a){console.error("Error verificando c\xF3digo:",a),this.message="El enlace ha expirado o no es v\xE1lido. Por favor, solicita un nuevo correo de recuperaci\xF3n.",this.messageType="error",this.isLoading=!1,setTimeout(()=>{this.step=1},3e3)}})}sendRecoveryEmail(){return x(this,null,function*(){if(!this.email){this.message="Por favor, ingresa tu correo electr\xF3nico",this.messageType="error";return}this.isLoading=!0,this.message="";try{yield this.authService.sendPasswordResetEmail(this.email),this.step=2}catch(e){this.message=e.message||"Error al enviar el correo. Verifica que el correo electr\xF3nico sea correcto.",this.messageType="error"}finally{this.isLoading=!1}})}resetPassword(){return x(this,null,function*(){if(!this.newPassword||!this.confirmPassword){this.message="Por favor, completa todos los campos",this.messageType="error";return}if(this.newPassword!==this.confirmPassword){this.message="Las contrase\xF1as no coinciden",this.messageType="error";return}if(this.newPassword.length<6){this.message="La contrase\xF1a debe tener al menos 6 caracteres",this.messageType="error";return}this.isLoading=!0,this.message="";try{yield this.authService.confirmPasswordReset(this.actionCode,this.newPassword),this.step=4}catch(e){this.message=e.message||"Error al cambiar la contrase\xF1a. Por favor, intenta nuevamente.",this.messageType="error"}finally{this.isLoading=!1}})}goToLogin(){this.router.navigate(["/login"])}togglePasswordVisibility(){this.showPassword=!this.showPassword}static \u0275fac=function(a){return new(a||i)(v(N),v(F),v(I))};static \u0275cmp=k({type:i,selectors:[["app-recuperar-contrasena"]],decls:10,vars:4,consts:[[1,"container"],[1,"card"],["src","icons/logo_Repo.png","alt","Logo de la Aplicaci\xF3n",1,"app-logo"],[1,"card-header"],[1,"card-body"],[4,"ngIf"],["class","message",3,"ngClass",4,"ngIf"],[1,"reset-form"],["type","email","placeholder","Ingresa tu correo","name","email",3,"ngModelChange","ngModel"],["type","button",1,"auth-button-primary",3,"click","disabled"],["class","loader-container",4,"ngIf"],["type","button",1,"auth-button-secondary",3,"click"],[1,"message",3,"ngClass"],[1,"loader-container"],["viewBox","0 0 50 50",1,"spinner"],["cx","25","cy","25","r","20","fill","none","stroke-width","5",1,"path"],[1,"success-icon"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M22 11.08V12a10 10 0 11-5.93-9.14"],["d","M22 4L12 14.01l-3-3"],["type","button",1,"auth-button-primary",3,"click"],[1,"password-input"],["placeholder","Nueva contrase\xF1a","name","newPassword",3,"ngModelChange","type","ngModel"],["type","button",1,"toggle-password",3,"click"],["d","M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"],["cx","12","cy","12","r","3"],["d","M3 3l18 18"],["type","password","placeholder","Confirmar contrase\xF1a","name","confirmPassword",3,"ngModelChange","ngModel"]],template:function(a,r){a&1&&(t(0,"div",0)(1,"div",1),u(2,"img",2),t(3,"div",3),o(4,"Recuperaci\xF3n de Contrase\xF1a"),n(),t(5,"div",4),h(6,Q,13,7,"div",5)(7,U,15,1,"div",5)(8,$,20,13,"div",5)(9,ee,11,0,"div",5),n()()()),a&2&&(s(6),c("ngIf",r.step===1),s(),c("ngIf",r.step===2),s(),c("ngIf",r.step===3),s(),c("ngIf",r.step===4))},dependencies:[L,O,R,H,B,W,j,z,G,A],styles:[`.container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f5f7fa;padding:1rem}.card[_ngcontent-%COMP%]{width:100%;max-width:400px;background:#fff;border-radius:10px;box-shadow:0 4px 10px #0000001a;padding:2rem;text-align:center}.app-logo[_ngcontent-%COMP%]{width:120px;margin-bottom:1rem}.card-header[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;margin-bottom:.5rem;color:#333}.card-body[_ngcontent-%COMP%]{margin-top:1rem}.reset-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;margin-top:1.5rem}label[_ngcontent-%COMP%]{text-align:left;font-size:.9rem;color:#555;margin-bottom:-.5rem}input[_ngcontent-%COMP%]{padding:.8rem 1rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;width:100%}input.input-error[_ngcontent-%COMP%]{border-color:#e53935}.message[_ngcontent-%COMP%]{padding:.8rem;border-radius:4px;margin-top:1rem}.message.error[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828;border:1px solid #ffcdd2}.message.success[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32;border:1px solid #c8e6c9}.auth-button-primary[_ngcontent-%COMP%]{padding:.8rem;border-radius:4px;font-size:1rem;cursor:pointer;transition:background-color .3s;background-color:#3f51b5;color:#fff;border:none}.auth-button-primary[_ngcontent-%COMP%]:hover{background-color:#303f9f}.auth-button-primary[_ngcontent-%COMP%]:disabled{background-color:#c5cae9;cursor:not-allowed}.auth-button-secondary[_ngcontent-%COMP%]{padding:.8rem;border-radius:4px;font-size:1rem;cursor:pointer;transition:background-color .3s;background-color:transparent;color:#3f51b5;border:1px solid #3f51b5}.auth-button-secondary[_ngcontent-%COMP%]:hover{background-color:#f5f5f5}.loader-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:8px}.spinner[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_rotate 2s linear infinite;width:20px;height:20px}.path[_ngcontent-%COMP%]{stroke:#fff;stroke-linecap:round;animation:_ngcontent-%COMP%_dash 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_rotate{to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_dash{0%{stroke-dasharray:1,150;stroke-dashoffset:0}50%{stroke-dasharray:90,150;stroke-dashoffset:-35}to{stroke-dasharray:90,150;stroke-dashoffset:-124}}.success-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 1.5rem;color:#4caf50}.success-icon[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:100%;height:100%}h2[_ngcontent-%COMP%]{margin-bottom:1rem;color:#333}.password-input[_ngcontent-%COMP%]{position:relative;width:100%}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:10px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:#777;padding:0;width:24px;height:24px;display:flex;align-items:center;justify-content:center}.toggle-password[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:20px;height:20px}
/*# sourceMappingURL=recuperar-contrasena.component-ZPYQI62K.css.map */`]})}return i})();export{ce as RecuperarContrasenaComponent};
//# sourceMappingURL=chunk-HVVDXZ2Q.js.map
