import{K as h,M as l,N as u,O as o,P as w,Q as y,S as i,U as c,X as p}from"./chunk-7XAWW6QG.js";import{T as f,Z as D,s as d}from"./chunk-GCXAMRXK.js";import{g as m}from"./chunk-OIKEWKHE.js";var N=(()=>{class a{firestore=D(h);getDepartments(){let t=o(this.firestore,"Departamento");return l(t,{idField:"IdDepartamento"}).pipe(d(e=>e.map(r=>({IdDepartamento:r.IdDepartamento,Nombre:r.Nombre,id:r.IdDepartamento,name:r.Nombre}))))}addDepartment(t){return m(this,null,function*(){try{let e=o(this.firestore,"Departamento"),r=c(e,p("Nombre","==",t));if(!(yield i(r)).empty)throw new Error("Ya existe un departamento con este nombre");let n=t.toLowerCase().trim().replace(/\s+/g,"_"),s={IdDepartamento:n,Nombre:t};return yield u(o(this.firestore,"Departamento"),s),n}catch(e){throw console.error("Error al a\xF1adir departamento:",e),e}})}deleteDepartment(t){return m(this,null,function*(){try{let e=o(this.firestore,"Usuario"),r=c(e,p("Departamento","==",t));if(!(yield i(r)).empty)throw new Error("No se puede eliminar el departamento porque hay usuarios asignados a \xE9l");let n=c(o(this.firestore,"Departamento"),p("IdDepartamento","==",t)),s=yield i(n);if(s.empty)throw new Error("Departamento no encontrado");yield w(y(this.firestore,"Departamento",s.docs[0].id))}catch(e){throw console.error("Error al eliminar departamento:",e),e}})}static \u0275fac=function(e){return new(e||a)};static \u0275prov=f({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();export{N as a};
//# sourceMappingURL=chunk-GFZFYLPE.js.map
