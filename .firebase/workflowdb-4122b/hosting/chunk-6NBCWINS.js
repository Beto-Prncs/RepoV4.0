import{a as S}from"./chunk-LQAXUOUF.js";import"./chunk-P5C6PN4L.js";import"./chunk-NOIAGMWN.js";import{L as E,y as w}from"./chunk-5O2P5WTG.js";import{c as h,d as b,e as T,k as y,u as I,x as M}from"./chunk-4ACV6U3O.js";import{Bb as v,Cb as l,Jb as r,Kb as u,Lb as m,Qa as n,Z as g,_a as x,a as f,db as d,ia as k,ja as _,lb as s,vb as a,wb as i,xb as C}from"./chunk-F77T7Y3R.js";import"./chunk-OIKEWKHE.js";function O(t,c){if(t&1&&(a(0,"div",10),r(1),i()),t&2){let e=l();n(),m(" ",e.errorMessage," ")}}function P(t,c){if(t&1&&(a(0,"div",11),r(1),i()),t&2){let e=l();n(),m(" ",e.successMessage," ")}}function W(t,c){t&1&&(a(0,"div",12)(1,"p"),r(2,"Cargando reportes completados..."),i()())}function D(t,c){t&1&&(a(0,"div",13)(1,"p"),r(2,"No hay reportes completados."),i()())}function L(t,c){if(t&1&&(a(0,"p",28)(1,"strong"),r(2,"Descripci\xF3n:"),i(),r(3),i()),t&2){let e=l().$implicit;n(3),m(" ",e.jobDescription," ")}}function j(t,c){if(t&1&&(a(0,"p",29)(1,"strong"),r(2,"Ubicaci\xF3n:"),i(),r(3),i()),t&2){let e=l().$implicit;n(3),m(" ",e.location," ")}}function F(t,c){if(t&1&&(a(0,"span",30),r(1),i()),t&2){let e=l().$implicit,o=l(2);s("ngClass",o.getPriorityClass(e.priority)),n(),m(" ",e.priority," ")}}function z(t,c){if(t&1&&(a(0,"p",31)(1,"strong"),r(2,"Departamento:"),i(),r(3),i()),t&2){let e=l().$implicit;n(3),m(" ",e.departamento," ")}}function R(t,c){if(t&1&&(a(0,"div",32)(1,"strong"),r(2,"Descripci\xF3n del trabajo"),i(),a(3,"p"),r(4),i()()),t&2){let e=l().$implicit;n(4),u(e.descripcionCompletado)}}function $(t,c){if(t&1&&(a(0,"div",16)(1,"div",17)(2,"h3"),r(3),i(),a(4,"span",18),r(5),i()(),a(6,"div",19)(7,"div",20),d(8,L,4,1,"p",21)(9,j,4,1,"p",22),a(10,"div",23)(11,"span",24),r(12),i(),d(13,F,2,2,"span",25),i(),d(14,z,4,1,"p",26),i(),d(15,R,5,1,"div",27),i()()),t&2){let e=c.$implicit,o=l(2);n(3),u(e.Tipo_Trabajo),n(2),m("Completado: ",o.formatDate(e.fechaCompletado||e.fecha),""),n(3),s("ngIf",e.jobDescription),n(),s("ngIf",e.location),n(2),s("ngClass",o.getStatusClass(e.estado)),n(),m(" ",e.estado," "),n(),s("ngIf",e.priority),n(),s("ngIf",e.departamento),n(),s("ngIf",e.descripcionCompletado)}}function A(t,c){if(t&1&&(a(0,"div",14),d(1,$,16,9,"div",15),i()),t&2){let e=l();n(),s("ngForOf",e.completedTasks)}}var X=(()=>{class t{taskService=g(S);router=g(I);auth=g(w);completedTasks=[];subscription;isLoading=!0;errorMessage="";successMessage="";ngOnInit(){console.log("Inicializando componente worker-completetask"),this.setupAuthListener()}setupAuthListener(){let e=this.auth.onAuthStateChanged(o=>{o?(console.log("Usuario autenticado:",o.uid),this.loadCompletedTasks(o.uid)):(console.log("No hay usuario autenticado"),this.router.navigate(["/login"]))});e&&(this.subscription=new f(()=>e()))}loadCompletedTasks(e){let o=this.taskService.getCompletedReportesByWorker(e).subscribe({next:p=>{console.log("Reportes completados recibidos:",p),this.completedTasks=p,this.isLoading=!1},error:p=>{console.error("Error al cargar reportes completados:",p),this.showError("Error al cargar los reportes completados"),this.isLoading=!1}});o&&(this.subscription?this.subscription.add(o):this.subscription=o)}convertToDate(e){return e instanceof E?e.toDate():e}formatDate(e){let o=this.convertToDate(e);return new Intl.DateTimeFormat("es",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(o)}getStatusClass(e){switch(e.toLowerCase()){case"completado":return"status-completed";case"pendiente":return"status-pending";default:return"status-default"}}getPriorityClass(e){switch(e.toLowerCase()){case"alta":return"priority-high";case"media":return"priority-medium";case"baja":return"priority-low";default:return"priority-default"}}showError(e){this.errorMessage=e,setTimeout(()=>{this.errorMessage=""},5e3)}showSuccess(e){this.successMessage=e,setTimeout(()=>{this.successMessage=""},3e3)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}goBack(){this.router.navigate(["/worker"])}static \u0275fac=function(o){return new(o||t)};static \u0275cmp=x({type:t,selectors:[["app-worker-completetask"]],decls:13,vars:5,consts:[[1,"tasks-container"],[1,"btn-back",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round"],["x1","19","y1","12","x2","5","y2","12"],["points","12 19 5 12 12 5"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","no-tasks",4,"ngIf"],["class","tasks-grid",4,"ngIf"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"loading-state"],[1,"no-tasks"],[1,"tasks-grid"],["class","task-card",4,"ngFor","ngForOf"],[1,"task-card"],[1,"task-header"],[1,"task-date"],[1,"task-content"],[1,"task-info"],["class","task-description",4,"ngIf"],["class","task-location",4,"ngIf"],[1,"task-tags"],[1,"status-badge",3,"ngClass"],["class","priority-badge",3,"ngClass",4,"ngIf"],["class","task-department",4,"ngIf"],["class","completion-description",4,"ngIf"],[1,"task-description"],[1,"task-location"],[1,"priority-badge",3,"ngClass"],[1,"task-department"],[1,"completion-description"]],template:function(o,p){o&1&&(a(0,"div",0)(1,"button",1),v("click",function(){return p.goBack()}),k(),a(2,"svg",2),C(3,"line",3)(4,"polyline",4),i(),r(5," Atr\xE1s "),i(),_(),a(6,"h2"),r(7,"Reportes Completados"),i(),d(8,O,2,1,"div",5)(9,P,2,1,"div",6)(10,W,3,0,"div",7)(11,D,3,0,"div",8)(12,A,2,1,"div",9),i()),o&2&&(n(8),s("ngIf",p.errorMessage),n(),s("ngIf",p.successMessage),n(),s("ngIf",p.isLoading),n(),s("ngIf",!p.isLoading&&p.completedTasks.length===0),n(),s("ngIf",!p.isLoading&&p.completedTasks.length>0))},dependencies:[y,h,b,T,M],styles:[`.tasks-container[_ngcontent-%COMP%]{padding:2rem;max-width:1200px;margin:0 auto}h2[_ngcontent-%COMP%]{color:#1a237e;font-size:1.875rem;font-weight:600;margin-bottom:1.5rem;letter-spacing:-.025em}.tasks-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:2rem;perspective:1000px}.task-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2.5rem 2rem;text-align:center;transition:all .4s cubic-bezier(.165,.84,.44,1);box-shadow:0 8px 30px #0000000f;position:relative;overflow:hidden}.task-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px) rotate3d(1,1,0,2deg);box-shadow:0 15px 35px #0000001a}.task-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.task-title[_ngcontent-%COMP%]{color:#1a237e;font-size:1.25rem;font-weight:600;margin-bottom:.5rem}.task-description[_ngcontent-%COMP%]{color:#64748b;font-size:.95rem;line-height:1.5}.task-status[_ngcontent-%COMP%]{display:inline-block;padding:.5rem 1rem;border-radius:9999px;font-size:.875rem;font-weight:500;margin-top:1rem}.task-status.completed[_ngcontent-%COMP%]{background-color:#ecfdf5;color:#047857}.completion-details[_ngcontent-%COMP%]{margin-top:1.5rem;padding-top:1.5rem;border-top:1px solid #e2e8f0;text-align:left}.completion-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#4b5563;font-size:.875rem;margin-bottom:.5rem;display:flex;justify-content:space-between}.completion-details[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#1a237e;font-weight:500}@media (max-width: 768px){.tasks-container[_ngcontent-%COMP%]{padding:1rem}.tasks-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:1rem}.completion-details[_ngcontent-%COMP%]{padding:1rem}}
/*# sourceMappingURL=worker-completetask.component-67BO575T.css.map */`]})}return t})();export{X as WorkerCompleteTaskComponent};
//# sourceMappingURL=chunk-6NBCWINS.js.map
